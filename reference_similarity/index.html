
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../reference_inference/">
      
      
        <link rel="next" href="../reference_training/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Similarity - Wildlife Tools</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2a3383ac.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#reference-similarity" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Wildlife Tools" class="md-header__button md-logo" aria-label="Wildlife Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wildlife Tools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Similarity
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/WildlifeDatasets/wildlife-tools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-tools
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Wildlife Tools" class="md-nav__button md-logo" aria-label="Wildlife Tools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Wildlife Tools
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/WildlifeDatasets/wildlife-tools" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    wildlife-tools
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training ML models
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Pre-trained models
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Pre-trained models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../megadescriptor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    MegaDescriptor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wildfusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WildFusion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    References
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_inference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Inference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Similarity
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Similarity
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#similarity.calibration" class="md-nav__link">
    <span class="md-ellipsis">
      calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration" class="md-nav__link">
    <span class="md-ellipsis">
      LogisticCalibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogisticCalibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration" class="md-nav__link">
    <span class="md-ellipsis">
      IsotonicCalibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IsotonicCalibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.reliability_diagram" class="md-nav__link">
    <span class="md-ellipsis">
      reliability_diagram
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.cosine" class="md-nav__link">
    <span class="md-ellipsis">
      cosine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cosine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.CosineSimilarity" class="md-nav__link">
    <span class="md-ellipsis">
      CosineSimilarity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CosineSimilarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.CosineSimilarity.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.wildfusion" class="md-nav__link">
    <span class="md-ellipsis">
      wildfusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wildfusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline" class="md-nav__link">
    <span class="md-ellipsis">
      SimilarityPipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimilarityPipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline.fit_calibration" class="md-nav__link">
    <span class="md-ellipsis">
      fit_calibration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion" class="md-nav__link">
    <span class="md-ellipsis">
      WildFusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WildFusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion.fit_calibration" class="md-nav__link">
    <span class="md-ellipsis">
      fit_calibration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs" class="md-nav__link">
    <span class="md-ellipsis">
      MatchPairs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MatchPairs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs.get_matches" class="md-nav__link">
    <span class="md-ellipsis">
      get_matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.lightglue" class="md-nav__link">
    <span class="md-ellipsis">
      lightglue
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lightglue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.lightglue.MatchLightGlue" class="md-nav__link">
    <span class="md-ellipsis">
      MatchLightGlue
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.loftr" class="md-nav__link">
    <span class="md-ellipsis">
      loftr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loftr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.loftr.MatchLOFTR" class="md-nav__link">
    <span class="md-ellipsis">
      MatchLOFTR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors" class="md-nav__link">
    <span class="md-ellipsis">
      collectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="collectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectAll" class="md-nav__link">
    <span class="md-ellipsis">
      CollectAll
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectCounts" class="md-nav__link">
    <span class="md-ellipsis">
      CollectCounts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectCountsRansac" class="md-nav__link">
    <span class="md-ellipsis">
      CollectCountsRansac
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#similarity.calibration" class="md-nav__link">
    <span class="md-ellipsis">
      calibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="calibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration" class="md-nav__link">
    <span class="md-ellipsis">
      LogisticCalibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LogisticCalibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.LogisticCalibration.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration" class="md-nav__link">
    <span class="md-ellipsis">
      IsotonicCalibration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IsotonicCalibration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.IsotonicCalibration.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.calibration.reliability_diagram" class="md-nav__link">
    <span class="md-ellipsis">
      reliability_diagram
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.cosine" class="md-nav__link">
    <span class="md-ellipsis">
      cosine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cosine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.CosineSimilarity" class="md-nav__link">
    <span class="md-ellipsis">
      CosineSimilarity
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CosineSimilarity">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.CosineSimilarity.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.cosine.cosine_similarity" class="md-nav__link">
    <span class="md-ellipsis">
      cosine_similarity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.wildfusion" class="md-nav__link">
    <span class="md-ellipsis">
      wildfusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="wildfusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline" class="md-nav__link">
    <span class="md-ellipsis">
      SimilarityPipeline
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SimilarityPipeline">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline.fit_calibration" class="md-nav__link">
    <span class="md-ellipsis">
      fit_calibration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.SimilarityPipeline.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion" class="md-nav__link">
    <span class="md-ellipsis">
      WildFusion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="WildFusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion.fit_calibration" class="md-nav__link">
    <span class="md-ellipsis">
      fit_calibration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.wildfusion.WildFusion.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs" class="md-nav__link">
    <span class="md-ellipsis">
      MatchPairs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MatchPairs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.base.MatchPairs.get_matches" class="md-nav__link">
    <span class="md-ellipsis">
      get_matches
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.lightglue" class="md-nav__link">
    <span class="md-ellipsis">
      lightglue
    </span>
  </a>
  
    <nav class="md-nav" aria-label="lightglue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.lightglue.MatchLightGlue" class="md-nav__link">
    <span class="md-ellipsis">
      MatchLightGlue
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.loftr" class="md-nav__link">
    <span class="md-ellipsis">
      loftr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="loftr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.loftr.MatchLOFTR" class="md-nav__link">
    <span class="md-ellipsis">
      MatchLOFTR
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors" class="md-nav__link">
    <span class="md-ellipsis">
      collectors
    </span>
  </a>
  
    <nav class="md-nav" aria-label="collectors">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectAll" class="md-nav__link">
    <span class="md-ellipsis">
      CollectAll
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectCounts" class="md-nav__link">
    <span class="md-ellipsis">
      CollectCounts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similarity.pairwise.collectors.CollectCountsRansac" class="md-nav__link">
    <span class="md-ellipsis">
      CollectCountsRansac
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="reference-similarity">Reference similarity</h1>


<div class="doc doc-object doc-module">



<h2 id="similarity.calibration" class="doc doc-heading">
            <code>similarity.calibration</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.calibration.LogisticCalibration" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">LogisticCalibration</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Performs logistic regression calibration.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.calibration.LogisticCalibration.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the logistic regression model to calibrate raw scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw uncalibrated scores.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hits</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth binary labels.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="similarity.calibration.LogisticCalibration.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict calibrated scores using a fitted calibration model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw uncalibrated scores.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>prediction</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Calibrated scores.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="similarity.calibration.IsotonicCalibration" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">IsotonicCalibration</span><span class="p">(</span><span class="n">interpolate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Performs isotonic regression calibration for ranking.</p>
<p>Compared to standard isotonic regression, this implementation uses spline interpolation
to ensure that the calibration curve is strictly increasing, which is necessary for ranking.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>interpolate</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, use spline interpolation for calibration.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strict</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, apply strict adjustment to predictions.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.calibration.IsotonicCalibration.fit" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">hits</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the isotonic regression model to calibrate the scores.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw uncalibrated scores.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hits</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth binary labels.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="similarity.calibration.IsotonicCalibration.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Predict calibrated scores using a fitted calibration model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw uncalibrated scores.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>calibrated_scores</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Calibrated scores.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="similarity.calibration.reliability_diagram" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reliability_diagram</span><span class="p">(</span><span class="n">scores</span><span class="p">,</span> <span class="n">hits</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Reliability Diagram&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculates ECE (Expected calibration error) and plots reliability diagram for a given set of
scores and hits.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>scores</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Raw uncalibrated scores.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hits</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ground truth binary labels.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="matplotlib.axes.Axes">Axes</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Axes to plot the diagram on. If None, a new figure is created.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>skip_plot</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, only return ECE value.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_bins</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of bins to divide the scores into.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title of the plot.</p>
              </div>
            </td>
            <td>
                  <code>&#39;Reliability Diagram&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>ece</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Expected Calibration Error.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.cosine" class="doc doc-heading">
            <code>similarity.cosine</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.cosine.CosineSimilarity" class="doc doc-heading">
            <code>CosineSimilarity</code>


</h3>


    <div class="doc doc-contents ">


        <p>Wraps cosine similarity to be usable in SimilarityPipeline.</p>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.cosine.CosineSimilarity.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">database</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculates cosine similarity given query and database feature datasets.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>query</code>
            </td>
            <td>
                  <code><span title="similarity.data.FeatureDataset">FeatureDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Query dataset of deep features.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>database</code>
            </td>
            <td>
                  <code><span title="similarity.data.FeatureDataset">FeatureDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Database dataset of deep features.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>similarity</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>2D numpy array with cosine similarity.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="similarity.cosine.cosine_similarity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cosine_similarity</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate cosine similarity between two sets of vectors.
Pytorch Equivalent to <code>sklearn.metrics.pairwise.cosine_similarity</code>.</p>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.wildfusion" class="doc doc-heading">
            <code>similarity.wildfusion</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.wildfusion.SimilarityPipeline" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">SimilarityPipeline</span><span class="p">(</span><span class="n">matcher</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">extractor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">calibration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Implements pipeline for matching and calculating similarity scores between two image datasets.</p>
<p>Given two (query and database) image datasets, the pipeline consists of the following steps:</p>
<pre><code>1. Apply image transforms.
2. Extract features for both datasets.
3. Compute similarity scores between query and database images.
4. Calibrate similarity scores.
</code></pre>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matcher</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A matcher that computes scores between two feature datasets.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extractor</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A function to extract features from the image datasets.
Not needed for some matchers.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>calibration</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A calibration model to refine similarity scores.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>transform</code>
            </td>
            <td>
                  <code><span title="callable">callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Image transformation function applied before feature
extraction.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.wildfusion.SimilarityPipeline.fit_calibration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_calibration</span><span class="p">(</span><span class="n">dataset0</span><span class="p">,</span> <span class="n">dataset1</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the calibration model using given two image datasets.
Fitting the calibration model uses all possible pairs of images from the two datasets.
Input scores are similarity scores calculated by the matcher.
Binary input labels are based on ground truth labels (identity is the same or not).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset0</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first dataset (e.g., part of training set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset1</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second dataset (e.g., part of training set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="similarity.wildfusion.SimilarityPipeline.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">dataset0</span><span class="p">,</span> <span class="n">dataset1</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute similarity scores between two image datasets, with optional calibration.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset0</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first dataset (e.g., query set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset1</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second dataset (e.g., database set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pairs</code>
            </td>
            <td>
                  <code>list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific pairs of images to compute similarity scores.
If None, compute similarity scores for all pairs.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>np.ndarray: 2D array of similarity scores between the query and database images.
If <code>calibration</code> is provided, return the calibrated similarity scores.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="similarity.wildfusion.WildFusion" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">WildFusion</span><span class="p">(</span><span class="n">calibrated_pipelines</span><span class="p">,</span> <span class="n">priority_pipeline</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p><code>WildFusion</code> uses the mean of multiple calibrated <code>SimilarityPipeline</code> to calculate fused scores.</p>
<p>Since many local feature matching models require deep neural network inference for each query and
database pair, the computation quickly becomes infeasible even for moderately sized datasets.</p>
<p>WildFusion can be used with a limited computational budget by applying it only B times per query
image. It uses a fast-to-compute similarity score (e.g., cosine similarity of deep features) provided
by the priority_pipeline to construct a shortlist of the most promising matches for a given query.
Final ranking is then based on WildFusion scores calculated for the pairs in the shortlist.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>calibrated_pipelines</code>
            </td>
            <td>
                  <code><span title="list">list</span>[<a class="autorefs autorefs-internal" title="SimilarityPipeline(matcher=None, extractor=None, calibration=None, transform=None) (similarity.wildfusion.SimilarityPipeline)" href="#similarity.wildfusion.SimilarityPipeline">SimilarityPipeline</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of SimilarityPipeline objects.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>priority_pipeline</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SimilarityPipeline(matcher=None, extractor=None, calibration=None, transform=None) (similarity.wildfusion.SimilarityPipeline)" href="#similarity.wildfusion.SimilarityPipeline">SimilarityPipeline</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Fast-to-compute similarity matcher
used for shortlisting.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.wildfusion.WildFusion.fit_calibration" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fit_calibration</span><span class="p">(</span><span class="n">dataset0</span><span class="p">,</span> <span class="n">dataset1</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Fit the all calibration models for all matchers in <code>calibrated_pipelines</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset0</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first dataset (e.g., part of training set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset1</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second dataset (e.g., part of training set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="similarity.wildfusion.WildFusion.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">dataset0</span><span class="p">,</span> <span class="n">dataset1</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Compute fused similarity scores between two images datasets using multiple calibrated
matchers. WildFusion score is is calculated as mean of calibrated similarity scores.</p>
<p>Optionally, to limit the number of pairs to compute, shortlist strategy to select the most
promising pairs can be used.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset0</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The first dataset (e.g., query set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset1</code>
            </td>
            <td>
                  <code><span title="similarity.data.ImageDataset">ImageDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The second dataset (e.g., database set).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pairs</code>
            </td>
            <td>
                  <code>list of tuples</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specific pairs of images to compute similarity scores.
                              If None, compute similarity scores for all pairs.
                              Is ignored if <code>B</code> is provided.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>B</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of pairs to compute similarity scores for. Required <code>priority_pipeline</code> to be assigned.
                              If None, compute similarity scores for all pairs.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>score_combined</code></td>            <td>
                  <code><span title="numpy.ndarray">ndarray</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>2D array of similarity scores between the query and database images.
        If <code>calibration</code> is provided, returns the calibrated similarity scores.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.pairwise.base" class="doc doc-heading">
            <code>similarity.pairwise.base</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.base.MatchPairs" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">MatchPairs</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tqdm_silent</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">collector</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Base class for matching pairs from two datasets.
Any child class needs to implement <code>get_matches</code> method that implements processing of pair batches.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch_size</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of pairs processed in one batch.</p>
              </div>
            </td>
            <td>
                  <code>128</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_workers</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of workers used for data loading.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tqdm_silent</code>
            </td>
            <td>
                  <code>(<span title="int">int</span>, <span title="bool">bool</span>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, progress bar is disabled.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>collector</code>
            </td>
            <td>
                  <code>(<span title="int">int</span>, <a class="autorefs autorefs-internal" title="CollectCounts(grid_dtype='float16', thresholds=(0.5,), **kwargs) (similarity.pairwise.collectors.CollectCounts)" href="#similarity.pairwise.collectors.CollectCounts">CollectCounts</a>)</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Collector object used for storing results.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="similarity.pairwise.base.MatchPairs.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">dataset0</span><span class="p">,</span> <span class="n">dataset1</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Match pairs of features from two feature datasets.
Output for each pair is stored and processed using the collector.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset0</code>
            </td>
            <td>
                  <code><span title="similarity.data.FeatureDataset">FeatureDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First dataset (e.g. query).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset1</code>
            </td>
            <td>
                  <code><span title="similarity.data.FeatureDataset">FeatureDataset</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second dataset (e.g. database).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pairs</code>
            </td>
            <td>
                  <code><span title="numpy.ndarray">ndarray</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Numpy array with pairs of indexes. If None, all pairs are used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exact output is determined by the used collector.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="similarity.pairwise.base.MatchPairs.get_matches" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_matches</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Process batch and get matches of pairs for the batch. Implemented in child classes.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>batch</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>4-tuple with indexes and data from PairDataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>results</code></td>            <td>
                  <code><span title="List">List</span>[<span title="dict">dict</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>list of standartized dictionaries with keys: idx0, idx1, score, kpts0, kpts1.
Length of list is equal to batch size.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.pairwise.lightglue" class="doc doc-heading">
            <code>similarity.pairwise.lightglue</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.lightglue.MatchLightGlue" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">MatchLightGlue</span><span class="p">(</span><span class="n">features</span><span class="p">,</span> <span class="n">init_threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatchPairs(batch_size=128, num_workers=0, tqdm_silent=False, collector=None) (similarity.pairwise.base.MatchPairs)" href="#similarity.pairwise.base.MatchPairs">MatchPairs</a></code></p>


        <p>Implements matching using LightGlue model correspondences.
Introduced in: "LightGlue: Local Feature Matching at Light Speed"</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>features</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Features used for matching. Options: 'sift', 'superpoint', 'aliked',
'disk'. Must match extracted features from the dataset.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep matches only over this threshold. Matches with
lower values are not passed to the collector.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Device used for inference. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.pairwise.loftr" class="doc doc-heading">
            <code>similarity.pairwise.loftr</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.loftr.MatchLOFTR" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">MatchLOFTR</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="s1">&#39;outdoor&#39;</span><span class="p">,</span> <span class="n">init_threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">apply_fine</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="MatchPairs(batch_size=128, num_workers=0, tqdm_silent=False, collector=None) (similarity.pairwise.base.MatchPairs)" href="#similarity.pairwise.base.MatchPairs">MatchPairs</a></code></p>


        <p>Implements matching pairs using LoFTR model correspondences.
Introduced in: "LoFTR: Detector-Free Local Feature Matching with Transformers"</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pretrained</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LOFTR model used. <code>outdoor</code> or <code>indoor</code>.</p>
              </div>
            </td>
            <td>
                  <code>&#39;outdoor&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>device</code>
            </td>
            <td>
                  <code><span title="str">str</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Specifies device used for the inference.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>init_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keep matches only over this threshold.</p>
              </div>
            </td>
            <td>
                  <code>0.2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>apply_fine</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Use LoFTR fine refinement of keypoints locations. Has no effect on
confidence, but is faster without fine refinement. False by default.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="similarity.pairwise.collectors" class="doc doc-heading">
            <code>similarity.pairwise.collectors</code>


</h2>

    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.collectors.CollectAll" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">CollectAll</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Collect the results without additional processing.
Collected data is list of matcher results for each pair. Usefull for keypoint visualizations.</p>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.collectors.CollectCounts" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">CollectCounts</span><span class="p">(</span><span class="n">grid_dtype</span><span class="o">=</span><span class="s1">&#39;float16&#39;</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">


        <p>Collect count of significant matches given confidence thresholds.
Output is stored in [n_query x n_database] grid.</p>
<p>If multiple thresholds are provided, returns a dictionary with each threshold as a key and
the corresponding grid as value.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grid_dtype</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the output grid.</p>
              </div>
            </td>
            <td>
                  <code>&#39;float16&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>thresholds</code>
            </td>
            <td>
                  <code><span title="tuple">tuple</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Confidence thresholds for counting.</p>
              </div>
            </td>
            <td>
                  <code>(0.5,)</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="similarity.pairwise.collectors.CollectCountsRansac" class="doc doc-heading">
              <code class="highlight language-python"><span class="n">CollectCountsRansac</span><span class="p">(</span><span class="n">grid_dtype</span><span class="o">=</span><span class="s1">&#39;float16&#39;</span><span class="p">,</span> <span class="n">ransacReprojThreshold</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="n">cv2</span><span class="o">.</span><span class="n">USAC_MAGSAC</span><span class="p">,</span> <span class="n">confidence</span><span class="o">=</span><span class="mf">0.999</span><span class="p">,</span> <span class="n">maxIters</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="CollectCounts(grid_dtype='float16', thresholds=(0.5,), **kwargs) (similarity.pairwise.collectors.CollectCounts)" href="#similarity.pairwise.collectors.CollectCounts">CollectCounts</a></code></p>


        <p>Collect count of RANSAC inliers of fundamental matrix estimate.
Output is stored in [n_query x n_database] grid.</p>



<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grid_dtype</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Data type of the output grid.</p>
              </div>
            </td>
            <td>
                  <code>&#39;float16&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ransacReprojThreshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OpenCV RANSAC reprojection threshold.</p>
              </div>
            </td>
            <td>
                  <code>1.0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>method</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OpenCV RANSAC method.</p>
              </div>
            </td>
            <td>
                  <code><span title="cv2.USAC_MAGSAC">USAC_MAGSAC</span></code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>confidence</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OpenCV RANSAC confidence.</p>
              </div>
            </td>
            <td>
                  <code>0.999</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxIters</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>OpenCV RANSAC max iterations.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>











  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.sections", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>